<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ëœë¤ íŒ€ ë‚˜ëˆ„ê¸°</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>â­ï¸</text></svg>">
  <style>
    body {
      font-family: Pretendard, sans-serif;
      background-color: #f0f8ff;
      padding: 2rem;
      color: #333;
    }
    h1 {
      color: #0077cc;
    }
    textarea, input, select, button {
      margin-top: 0.5rem;
      margin-bottom: 1rem;
      width: 100%;
      padding: 0.5rem;
      font-size: 1rem;
    }
    button {
      background-color: #0077cc;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.2s;
    }
    button:hover {
      background-color: #005fa3;
    }

	/* ë ˆì´ì•„ì›ƒ ë¶„í•  */
	.form-grid {
	  display: flex;
	  flex-direction: column;
	  gap: 1rem;
	}
	
	.left-column,
	.right-column {
	  width: 100%;
	}
	
	/* í™”ë©´ì´ ë„“ì„ ë•Œ 2ë‹¨ ë ˆì´ì•„ì›ƒ */
	@media (min-width: 768px) {
	  .form-grid {
	    flex-direction: row;
	    gap: 2rem;
	  }
	
	  .left-column,
	  .right-column {
	    width: 50%;
	  }
	
	  .right-column {
	    display: flex;
	    flex-direction: column;
	    justify-content: flex-start;
	  }
	
	  .right-column label,
	  .right-column select,
	  .right-column input,
	  .right-column button {
	    margin-bottom: 1rem;
	  }
	}
	
	/* ì…ë ¥ ì¹¸ ìŠ¤íƒ€ì¼ */
	textarea.names-input {
		height: 100%;
		width: 100%;
		resize: none;
	}

    /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .modal-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.5);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal {
	  z-index: 1;
	  position: relative;
	  background: white;
	  border-radius: 16px;
	  width: 90%;
	  max-width: 600px;
	  max-height: 80vh;
	  overflow-y: auto;
	  animation: pop-in 0.4s ease-out;
	  display: flex;
	  flex-direction: column;
    }

    .modal-header {
	  background-color: #0077cc;
	  color: white;
	  padding: 1rem 1.25rem;
	  display: flex;
	  align-items: center;
	  border-top-left-radius: 16px;
	  border-top-right-radius: 16px;
	}

	.modal-title {
	  font-weight: bold;
	  font-size: 1.1rem;
	  flex: 1; /* íƒ€ì´í‹€ì´ ë‚¨ëŠ” ê³µê°„ì„ ì°¨ì§€í•˜ë„ë¡ */
	}
	
	.copy-btn {
	  font-size: 1.1rem;
	  background: none;
	  border: none;
	  color: white;
	  cursor: pointer;
	  padding: 0;
	  width: 50px;
	  height: 40px;
	}
	.copy-btn:hover {
	  opacity: 0.8;
	}

	.close-btn {
	  font-size: 1.1rem;
	  cursor: pointer;
	  color: white;
	  background: none;
	  border: none;
	  padding: 0;
	  line-height: 1;
	  width: 50px;
	  height: 40px;
	}
	.close-btn:hover {
	  opacity: 0.8;
	}


    .modal-content {
      padding: 1.5rem;
      overflow: auto;
    }
    
    #fireworksCanvas {
	  position: absolute;
	  top: 0; left: 0;
	  width: 100%;
	  height: 100%;
	  z-index: 0;
	  pointer-events: none;
	}

    @keyframes pop-in {
      0% { transform: scale(0.7); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    .team {
      background: #e6f2ff;
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .team h3 {
      margin-top: 0;
      color: #005fa3;
    }
  </style>
</head>
<body>
  <h1>âœ¨ ëœë¤ íŒ€ ë‚˜ëˆ„ê¸° </h1>
  <div class="form-grid">
  	<div class="left-column">
	  <label>ì´ë¦„ ëª©ë¡ (í•œ ì¤„ì— í•œ ëª…ì”©)</label>
	  <textarea id="namesInput" class="names-input" rows="8" placeholder="ì˜ˆ: ê¹€ë¯¼ìˆ˜&#10;ì´ì˜í¬&#10;ë°•ì§€í›ˆ" ></textarea>
	</div>
	<div class="right-column">
	  <label>ë¶„í•  ë°©ì‹ ì„ íƒ</label>
	  <select id="modeSelect">
	    <option value="teamCount">íŒ€ ìˆ˜ë¡œ ë‚˜ëˆ„ê¸°</option>
	    <option value="peoplePerTeam">íŒ€ë‹¹ ì¸ì› ìˆ˜ë¡œ ë‚˜ëˆ„ê¸°</option>
	  </select>
	
	  <label id="optionLabel">íŒ€ ìˆ˜</label>
	  <input type="number" id="optionValue" placeholder="ì˜ˆ: 3" min="1" />
	
	  <button onclick="makeTeams()">íŒ€ ë‚˜ëˆ„ê¸°</button>
	</div>
  </div>

  <!-- ê²°ê³¼ ëª¨ë‹¬ -->
  <div class="modal-overlay" id="modalOverlay">
	<canvas id="fireworksCanvas"></canvas>
    <div class="modal">
      <div class="modal-header">
		  <span class="modal-title">íŒ€ ê²°ê³¼ ë³´ê¸°</span>
		  <div style="display: flex; gap: 0.5rem;">
			<button class="copy-btn" onclick="copyResults()" title="íŒ€ ê²°ê³¼ ë³µì‚¬í•˜ê¸°">ğŸ“‹</button>
			<button class="close-btn" onclick="closeModal()" title="ë‹«ê¸°">âœ•</button>
		  </div>
		</div>
      <div class="modal-content" id="results"></div>
    </div>
  </div>

  <script>
    const modeSelect = document.getElementById("modeSelect");
    const optionLabel = document.getElementById("optionLabel");
    const optionValue = document.getElementById("optionValue");
    const resultsDiv = document.getElementById("results");
    const modalOverlay = document.getElementById("modalOverlay");
    const namesInput = document.getElementById("namesInput");

    const animalList = [
      { name: "í˜¸ë‘ì´", icon: "ğŸ¯" },
      { name: "ì—¬ìš°", icon: "ğŸ¦Š" },
      { name: "íŒë‹¤", icon: "ğŸ¼" },
      { name: "ê³ ì–‘ì´", icon: "ğŸ±" },
      { name: "ëŠ‘ëŒ€", icon: "ğŸº" },
      { name: "ëŒê³ ë˜", icon: "ğŸ¬" },
      { name: "ë¶€ì—‰ì´", icon: "ğŸ¦‰" },
      { name: "ì‚¬ì", icon: "ğŸ¦" },
      { name: "ê³ ë˜", icon: "ğŸ³" },
      { name: "í­ê·„", icon: "ğŸ§" },
      { name: "ë‹¤ëŒì¥", icon: "ğŸ¿ï¸" },
      { name: "í† ë¼", icon: "ğŸ°" },
      { name: "í•˜ë§ˆ", icon: "ğŸ¦›" },
      { name: "ì›ìˆ­ì´", icon: "ğŸµ" },
      { name: "ê°•ì•„ì§€", icon: "ğŸ¶" },
      { name: "ìº¥ê±°ë£¨", icon: "ğŸ¦˜" },
      { name: "ì•…ì–´", icon: "ğŸŠ" },
      { name: "ê¸°ë¦°", icon: "ğŸ¦’" },
      { name: "ì¹˜íƒ€", icon: "ğŸ†" },
      { name: "ìˆ˜ë‹¬", icon: "ğŸ¦¦" }
    ];

    modeSelect.addEventListener("change", () => {
      optionLabel.innerText = modeSelect.value === "teamCount" ? "íŒ€ ìˆ˜" : "íŒ€ë‹¹ ì¸ì› ìˆ˜";
      optionValue.value = "";
    });

    // ì…ë ¥ê°’ ì €ì¥
    [namesInput, modeSelect, optionValue].forEach(el => {
      el.addEventListener("input", () => {
        localStorage.setItem("names", namesInput.value);
        localStorage.setItem("mode", modeSelect.value);
        localStorage.setItem("value", optionValue.value);
      });
    });

    // ì €ì¥ëœ ê°’ ë³µì›
    window.addEventListener("DOMContentLoaded", () => {
      const storedNames = localStorage.getItem("names");
      const storedMode = localStorage.getItem("mode");
      const storedValue = localStorage.getItem("value");

      if (storedNames) namesInput.value = storedNames;
      if (storedMode) {
        modeSelect.value = storedMode;
        optionLabel.innerText = storedMode === "teamCount" ? "íŒ€ ìˆ˜" : "íŒ€ë‹¹ ì¸ì› ìˆ˜";
      }
      if (storedValue) optionValue.value = storedValue;
      updateMaxValue(); // max ì´ˆê¸° ì„¤ì •
    });
    
    function updateMaxValue() {
	  const names = namesInput.value
		.split("\n")
		.map(name => name.trim())
		.filter(name => name.length > 0);

	  const nameCount = names.length || 1; // ìµœì†Œ 1ë¡œ ì„¤ì •
	  optionValue.max = nameCount;
	}
	
	namesInput.addEventListener("input", updateMaxValue);
	modeSelect.addEventListener("change", updateMaxValue);
	
	function copyResults() {
	  const teams = resultsDiv.querySelectorAll(".team");
	  let text = "";

	  teams.forEach((teamDiv, index) => {
		const teamName = teamDiv.querySelector("h3").textContent.replace(/ğŸ¾|ğŸ¦|ğŸ¶|ğŸ±|ğŸ¯|ğŸ¦Š|ğŸ¼|ğŸµ|ğŸ°|ğŸ³|ğŸ¦’|ğŸŠ|ğŸ¦˜|ğŸ§|ğŸ¦›|ğŸ†|ğŸ¦¦|ğŸ¦‰|ğŸº|ğŸ¬|ğŸ¿ï¸/g, "").trim();
		const names = Array.from(teamDiv.querySelectorAll("li")).map(li => "- " + li.textContent);
		text += `${index + 1}. ${teamName}\n${names.join("\n")}`;
		if (index < teams.length - 1) text += "\n---\n";
	  });

	  navigator.clipboard.writeText(text).then(() => {
		alert("íŒ€ êµ¬ì„± ì •ë³´ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
	  }).catch(err => {
		alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
		console.error(err);
	  });
	}

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function makeTeams() {
      const names = namesInput.value
        .split("\n")
        .map(name => name.trim())
        .filter(name => name.length > 0);

      if (names.length < 2) {
        alert("ì´ë¦„ì„ ìµœì†Œ 2ëª… ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }

      const mode = modeSelect.value;
      const value = parseInt(optionValue.value);

      if (isNaN(value) || value <= 0) {
        alert("ì˜¬ë°”ë¥¸ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        return;
      }
      
      if (value > names.length) {
		  alert("ì…ë ¥í•œ ì´ë¦„ ìˆ˜ë³´ë‹¤ í° ìˆ«ìëŠ” ì…ë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
		  return;
		}

      shuffle(names);

      let teams = [];

      if (mode === "teamCount") {
        for (let i = 0; i < value; i++) {
          teams.push([]);
        }
        names.forEach((name, index) => {
          teams[index % value].push(name);
        });
      } else {
        const teamCount = Math.ceil(names.length / value);
        for (let i = 0; i < teamCount; i++) {
          teams.push([]);
        }
        names.forEach((name, index) => {
          teams[Math.floor(index / value)].push(name);
        });
      }

      displayTeams(teams);
    }
    
    function launchFireworks() {
	  const canvas = document.getElementById("fireworksCanvas");
	  const ctx = canvas.getContext("2d");
	  canvas.width = window.innerWidth;
	  canvas.height = window.innerHeight;

	  const particles = [];

	  function createBurst(x, y) {
		const count = Math.floor(Math.random() * 30) + 50;
		for (let i = 0; i < count; i++) {
		  particles.push({
			x,
			y,
			angle: Math.random() * 2 * Math.PI,
			speed: Math.random() * 5 + 2,
			radius: Math.random() * 3 + 1,
			color: `hsl(${Math.random() * 360}, 100%, 60%)`,
			alpha: 1,
			decay: Math.random() * 0.02 + 0.015
		  });
		}
	  }

	  // ì—¬ëŸ¬ ìœ„ì¹˜ì—ì„œ ìˆœì°¨ì ìœ¼ë¡œ í„°ì§
	  const positions = [
		[canvas.width / 2, canvas.height / 2], // ì¤‘ì•™
		[canvas.width * 0.2, canvas.height * 0.3],
		[canvas.width * 0.8, canvas.height * 0.3],
		[canvas.width * 0.3, canvas.height * 0.7],
		[canvas.width * 0.7, canvas.height * 0.75]
	  ];

	  let burstIndex = 0;
	  const burstInterval = setInterval(() => {
		if (burstIndex < positions.length) {
		  const [x, y] = positions[burstIndex];
		  createBurst(x, y);
		  burstIndex++;
		} else {
		  clearInterval(burstInterval);
		}
	  }, 300); // 0.3ì´ˆ ê°„ê²©ìœ¼ë¡œ ì—°ì† í„°ì§

	  const start = performance.now();

	  function animate(now) {
		ctx.clearRect(0, 0, canvas.width, canvas.height);

		particles.forEach(p => {
		  p.x += Math.cos(p.angle) * p.speed;
		  p.y += Math.sin(p.angle) * p.speed;
		  p.alpha -= p.decay;
		});

		particles.forEach(p => {
		  if (p.alpha <= 0) return;
		  ctx.beginPath();
		  ctx.globalAlpha = p.alpha;
		  ctx.fillStyle = p.color;
		  ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
		  ctx.fill();
		});

		ctx.globalAlpha = 1;

		if (performance.now() - start < 3000 || particles.some(p => p.alpha > 0)) {
		  requestAnimationFrame(animate);
		} else {
		  ctx.clearRect(0, 0, canvas.width, canvas.height);
		}
	  }

	  requestAnimationFrame(animate);
	}


    function displayTeams(teams) {
      resultsDiv.innerHTML = "";
      const used = [];

      teams.forEach((team, index) => {
        let animal;
        do {
          animal = animalList[Math.floor(Math.random() * animalList.length)];
        } while (used.includes(animal.name));
        used.push(animal.name);

        const div = document.createElement("div");
        div.className = "team";
        div.innerHTML = `<h3>${animal.icon} ${animal.name} íŒ€</h3><ul>${team.map(name => `<li>${name}</li>`).join("")}</ul>`;
        resultsDiv.appendChild(div);
      });

      modalOverlay.style.display = "flex";
      launchFireworks(); // ì¶•í¬ ì‹¤í–‰
    }

    function closeModal() {
      modalOverlay.style.display = "none";
    }
  </script>
</body>
</html>
